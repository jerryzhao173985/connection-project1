<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#050508">
    <title>Hidden Connections</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Main visualization canvas -->
    <canvas id="canvas"></canvas>

    <!-- Nebula background canvas (behind main) -->
    <canvas id="nebula-canvas"></canvas>

    <!-- Minimal header -->
    <header>
        <div class="header-content">
            <h1>Hidden Connections</h1>
            <p class="tagline">Semantic Nebula</p>
        </div>
        <div class="stats">
            <span id="point-count">0</span> souls
            <span class="dot">·</span>
            <span id="cluster-count">0</span> clusters
        </div>
    </header>

    <!-- Info Panel (corner, shows on hover) -->
    <aside id="info-panel" class="info-panel hidden">
        <div class="panel-header">
            <span class="panel-nickname" id="panel-nickname">anonymous</span>
            <span class="panel-cluster" id="panel-cluster"></span>
        </div>
        <div class="panel-body" id="panel-body"></div>
        <div class="panel-meta" id="panel-meta"></div>
    </aside>

    <!-- Your position indicator (after self-submission) -->
    <div id="your-marker" class="your-marker hidden">
        <span>YOU</span>
    </div>

    <!-- Add yourself button -->
    <button id="btn-add-self" class="add-self-btn" title="Find your place in the nebula">
        <span class="plus">+</span>
        <span class="label">Find My Place</span>
    </button>

    <!-- Help button -->
    <button id="btn-help" class="help-btn" title="About">?</button>

    <!-- Self Submission Modal -->
    <div id="submit-modal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">&times;</button>
            <h2>Find Your Place</h2>
            <p class="modal-intro">Answer these questions to discover where you belong in the semantic nebula. Everything is processed locally in your browser.</p>

            <form id="self-form">
                <div class="form-group">
                    <label for="q1">Describe a place where you feel very safe or "held"</label>
                    <textarea id="q1" name="q1_safe_place" rows="3" placeholder="A quiet forest clearing, my grandmother's kitchen..." required></textarea>
                </div>

                <div class="form-group">
                    <label for="q2">Think of a recent time you felt stressed. What happened, and how did you cope?</label>
                    <textarea id="q2" name="q2_stress" rows="3" placeholder="Describe the situation and how you handled it..." required></textarea>
                </div>

                <div class="form-group">
                    <label for="q3">Describe a moment when you felt understood, seen, or quietly cared for</label>
                    <textarea id="q3" name="q3_understood" rows="3" placeholder="A friend who noticed without being told..." required></textarea>
                </div>

                <div class="form-group">
                    <label for="q4">If you had a completely free day with no obligations, how would you spend it?</label>
                    <textarea id="q4" name="q4_free_day" rows="3" placeholder="Wake up slowly, read in the sun..." required></textarea>
                </div>

                <div class="form-group">
                    <label for="q5">One word to describe yourself, and why</label>
                    <textarea id="q5" name="q5_one_word" rows="2" placeholder="Curious - because I always want to understand..." required></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group half">
                        <label for="nickname">Nickname (optional)</label>
                        <input type="text" id="nickname" name="nickname" placeholder="anonymous">
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn secondary" id="cancel-btn">Cancel</button>
                    <button type="submit" class="btn primary" id="submit-btn">
                        <span class="btn-text">Find My Place</span>
                        <span class="btn-loading hidden">Processing...</span>
                    </button>
                </div>
            </form>

            <div id="processing-status" class="processing-status hidden">
                <div class="spinner"></div>
                <div class="status-text" id="status-text">Loading model...</div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal hidden">
        <div class="modal-content small">
            <button class="modal-close" id="help-close">&times;</button>
            <h2>Hidden Connections</h2>
            <p class="philosophy">People who have never spoken can end up adjacent in semantic space purely from how they describe their inner worlds.</p>

            <h3>The Nebula</h3>
            <p>Each star is a person. The colored clouds behind them represent clusters of similar responses, detected by machine learning. Thin lines connect nearest neighbors within each cluster—a constellation of kindred minds.</p>

            <h3>Interaction</h3>
            <p>Hover over any star to illuminate it and its neighbors. The connecting lines pulse with activity, and a panel reveals their words.</p>

            <h3>Find Your Place</h3>
            <p>Click the + button to answer the questions yourself. Your responses are embedded locally using a neural network running entirely in your browser—nothing leaves your device.</p>

            <div class="shortcuts">
                <h3>Shortcuts</h3>
                <div class="shortcut"><kbd>Space</kbd> Find your place</div>
                <div class="shortcut"><kbd>?</kbd> Toggle help</div>
                <div class="shortcut"><kbd>Esc</kbd> Close</div>
            </div>
        </div>
    </div>

    <script type="module" src="main.js"></script>
</body>
</html>
